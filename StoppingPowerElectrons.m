function S = StoppingPowerElectrons(E,material,type)

% PURPOSE:  Returns the electron stopping power S.
%           Use tabulated data and linear interpolation for evaluation.

% INPUT:    energy E    =    5e-5 MeV ... 1000 MeV
%           material    =    104: Air,   Z=7.2620 | 118: Blood,  Z=3.4532 | 
%                            119: Bone,  Z=4.4082 | 202: Muscle, Z=3.4715 | 
%                            251: Skin,  Z=3.4125 | 262: Tissue, Z=3.3527 |
%                            278: Water, Z=10
%                            [Z = atomic number]
%           type        =    col: collision stopping power 
%                            tot: collision+radiative stopping power

% OUTPUT:   collision or collision+radiative stopping power S

% UNITS:    [S]         =   MeV/cm
%           [E]         =   MeV
%           material    =   natural number
%           type        =   string

% EXPLANATIONS:     stopping power              =   average energy loss per unit path length
%                   collision stopping power    =   e-e interactions with shell electrons
%                   radiative stoppping power   =   energy loss due to Bremsstrahlung
%
% NOTE:             Bremsstrahlung effects negligible for E < 1MeV

% REFERENCES    
% Tabulated Data:   ICRU-77, Elastic Scattering of Electrons and Protons, vol.7, Oxford University Press, 2007
% Atomic number Z:  PENELOPE-2008, A Code System for Monte Carlo Simulation of Electron and Photon Transport, Block Data Pendat

% Author:   Edgar Olbrant

E = E(:);
if any(E<5e-5) || any(E>1e3)
    error('Energy E out of range. Note that E = 5e-5 MeV ... 1000 MeV');
end

E_tab = [5e-05;6e-05;7e-05;8e-05;9e-05;0.0001;0.000125;0.00015;0.000175;0.0002;0.00025;0.0003;0.00035;0.0004;0.00045;0.0005;0.0006;0.0007;0.0008;0.0009;0.001;0.00125;0.0015;0.00175;0.002;0.0025;0.003;0.0035;0.004;0.00450;0.00500;0.00600;0.00700;0.00800;0.00900;0.0100;0.0125;0.0150;0.0175;0.0200;0.0250;0.0300;0.0350;0.0400;0.0450;0.0500;0.0600;0.0700;0.0800;0.0900;0.100;0.125;0.150;0.175;0.200;0.250;0.300;0.350;0.400;0.450;0.500;0.600;0.700;0.800;0.900;1;1.25;1.50;1.75;2;2.50;3;3.50;4;4.50;5;6;7;8;9;10;12.5;15;17.5;20;25;30;35;40;45;50;60;70;80;90;100;125;150;175;200;250;300;350;400;450;500;600;700;800;900;1000];

switch material
     
    case 104 
    switch type 
    case 'col' 
    S_tab = [4.071985e-01; 4.294522e-01; 4.490313e-01; 4.467855e-01; 4.410700e-01; 4.326329e-01; 4.051480e-01; 3.779908e-01; 3.530227e-01; 3.308775e-01; 2.941471e-01; 2.652478e-01; 2.419941e-01; 2.228765e-01; 2.068649e-01; 1.932411e-01; 1.713729e-01; 1.543842e-01; 1.407797e-01; 1.329076e-01; 1.247560e-01; 1.085433e-01; 9.603706e-02; 8.639525e-02; 7.881821e-02; 6.735704e-02; 5.907555e-02; 5.277679e-02; 4.781269e-02; 4.379050e-02; 4.045890e-02; 3.524529e-02; 3.134020e-02; 2.829389e-02; 2.584479e-02; 2.382906e-02; 2.005542e-02; 1.741777e-02; 1.546203e-02; 1.394966e-02; 1.175556e-02; 1.023435e-02; 9.113911e-03; 8.252378e-03; 7.568262e-03; 7.011251e-03; 6.157923e-03; 5.534010e-03; 5.057504e-03; 4.681513e-03; 4.377255e-03; 3.821943e-03; 3.446880e-03; 3.177453e-03; 2.975313e-03; 2.694296e-03; 2.510638e-03; 2.383267e-03; 2.291270e-03; 2.222850e-03; 2.170875e-03; 2.099467e-03; 2.055408e-03; 2.027866e-03; 2.010891e-03; 2.000939e-03; 1.994168e-03; 2.000903e-03; 2.013746e-03; 2.029348e-03; 2.063058e-03; 2.096347e-03; 2.127671e-03; 2.156719e-03; 2.183561e-03; 2.208404e-03; 2.252885e-03; 2.291703e-03; 2.326028e-03; 2.356738e-03; 2.384496e-03; 2.443989e-03; 2.493132e-03; 2.534975e-03; 2.571371e-03; 2.632442e-03; 2.681814e-03; 2.719428e-03; 2.749042e-03; 2.773330e-03; 2.793860e-03; 2.827269e-03; 2.853870e-03; 2.876002e-03; 2.894942e-03; 2.911532e-03; 2.945748e-03; 2.972988e-03; 2.995614e-03; 3.014939e-03; 3.046709e-03; 3.072118e-03; 3.093178e-03; 3.111057e-03; 3.126502e-03; 3.140032e-03; 3.162779e-03; 3.181284e-03; 3.196778e-03; 3.210042e-03; 3.221608e-03]; 
    S = interp1q(E_tab,S_tab,E); 
    case 'tot' 
    S_tab = [4.072002e-01; 4.294540e-01; 4.490331e-01; 4.467874e-01; 4.410720e-01; 4.326349e-01; 4.051501e-01; 3.779930e-01; 3.530250e-01; 3.308799e-01; 2.941496e-01; 2.652504e-01; 2.419968e-01; 2.228793e-01; 2.068677e-01; 1.932440e-01; 1.713760e-01; 1.543874e-01; 1.407830e-01; 1.329110e-01; 1.247595e-01; 1.085469e-01; 9.604088e-02; 8.639919e-02; 7.882224e-02; 6.736122e-02; 5.907984e-02; 5.278116e-02; 4.781713e-02; 4.379498e-02; 4.046342e-02; 3.524987e-02; 3.134482e-02; 2.829854e-02; 2.584946e-02; 2.383374e-02; 2.006013e-02; 1.742249e-02; 1.546676e-02; 1.395440e-02; 1.176031e-02; 1.023912e-02; 9.118694e-03; 8.257175e-03; 7.573073e-03; 7.016079e-03; 6.162790e-03; 5.538922e-03; 5.062465e-03; 4.686526e-03; 4.382324e-03; 3.827161e-03; 3.452260e-03; 3.183007e-03; 2.981052e-03; 2.700440e-03; 2.517227e-03; 2.390337e-03; 2.298850e-03; 2.230968e-03; 2.179556e-03; 2.109339e-03; 2.066543e-03; 2.040333e-03; 2.024745e-03; 2.016237e-03; 2.013271e-03; 2.024061e-03; 2.041183e-03; 2.061253e-03; 2.104365e-03; 2.147583e-03; 2.189263e-03; 2.229018e-03; 2.266855e-03; 2.302951e-03; 2.370608e-03; 2.433347e-03; 2.492186e-03; 2.547892e-03; 2.601072e-03; 2.725700e-03; 2.841691e-03; 2.951646e-03; 3.057239e-03; 3.259492e-03; 3.452631e-03; 3.635735e-03; 3.812471e-03; 3.985457e-03; 4.155754e-03; 4.490915e-03; 4.822738e-03; 5.152802e-03; 5.481288e-03; 5.809064e-03; 6.627622e-03; 7.445602e-03; 8.262811e-03; 9.079550e-03; 1.071163e-02; 1.234319e-02; 1.397437e-02; 1.560545e-02; 1.723604e-02; 1.886712e-02; 2.213111e-02; 2.539629e-02; 2.866291e-02; 3.193139e-02; 3.520035e-02]; 
    S = interp1q(E_tab,S_tab,E); 
    end 


    case 118 
    switch type 
    case 'col' 
    S_tab = [3.998765e+02; 4.004648e+02; 4.429443e+02; 4.534797e+02; 4.502721e+02; 4.416479e+02; 4.127004e+02; 3.873357e+02; 3.630436e+02; 3.410296e+02; 3.040239e+02; 2.746460e+02; 2.508956e+02; 2.313238e+02; 2.148864e+02; 2.008965e+02; 1.782454e+02; 1.612896e+02; 1.474259e+02; 1.359821e+02; 1.263976e+02; 1.092881e+02; 9.712017e+01; 8.730128e+01; 7.940290e+01; 6.758284e+01; 5.921966e+01; 5.285308e+01; 4.783907e+01; 4.378044e+01; 4.042204e+01; 3.517398e+01; 3.124721e+01; 2.818805e+01; 2.573161e+01; 2.371188e+01; 1.993510e+01; 1.729888e+01; 1.534636e+01; 1.383788e+01; 1.165141e+01; 1.013716e+01; 9.022699e+00; 8.166304e+00; 7.486610e+00; 6.933449e+00; 6.086446e+00; 5.467512e+00; 4.995006e+00; 4.622300e+00; 4.320783e+00; 3.770674e+00; 3.399261e+00; 3.132523e+00; 2.932416e+00; 2.654240e+00; 2.472408e+00; 2.346257e+00; 2.254991e+00; 2.186261e+00; 2.133165e+00; 2.057979e+00; 2.008944e+00; 1.975840e+00; 1.953008e+00; 1.937076e+00; 1.915399e+00; 1.907841e+00; 1.907184e+00; 1.910120e+00; 1.920826e+00; 1.933790e+00; 1.946987e+00; 1.959707e+00; 1.971717e+00; 1.982963e+00; 2.003294e+00; 2.021102e+00; 2.036832e+00; 2.050867e+00; 2.063470e+00; 2.090182e+00; 2.111827e+00; 2.129879e+00; 2.145260e+00; 2.170329e+00; 2.190151e+00; 2.206432e+00; 2.220202e+00; 2.232106e+00; 2.242578e+00; 2.260365e+00; 2.275120e+00; 2.287724e+00; 2.298748e+00; 2.308532e+00; 2.329085e+00; 2.345748e+00; 2.359761e+00; 2.371867e+00; 2.392028e+00; 2.408458e+00; 2.422333e+00; 2.434343e+00; 2.444922e+00; 2.454377e+00; 2.470743e+00; 2.484566e+00; 2.496533e+00; 2.507091e+00; 2.516535e+00]; 
    S = interp1q(E_tab,S_tab,E); 
    case 'tot' 
    S_tab = [3.998780e+02; 4.004663e+02; 4.429459e+02; 4.534813e+02; 4.502738e+02; 4.416496e+02; 4.127022e+02; 3.873375e+02; 3.630456e+02; 3.410316e+02; 3.040260e+02; 2.746482e+02; 2.508979e+02; 2.313262e+02; 2.148888e+02; 2.008990e+02; 1.782480e+02; 1.612923e+02; 1.474287e+02; 1.359850e+02; 1.264005e+02; 1.092913e+02; 9.712344e+01; 8.730465e+01; 7.940636e+01; 6.758643e+01; 5.922334e+01; 5.285684e+01; 4.784289e+01; 4.378430e+01; 4.042594e+01; 3.517794e+01; 3.125120e+01; 2.819207e+01; 2.573565e+01; 2.371594e+01; 1.993919e+01; 1.730298e+01; 1.535047e+01; 1.384199e+01; 1.165554e+01; 1.014130e+01; 9.026853e+00; 8.170470e+00; 7.490790e+00; 6.937643e+00; 6.090674e+00; 5.471779e+00; 4.999317e+00; 4.626657e+00; 4.325188e+00; 3.775211e+00; 3.403940e+00; 3.137355e+00; 2.937411e+00; 2.659590e+00; 2.478148e+00; 2.352419e+00; 2.261601e+00; 2.193341e+00; 2.140738e+00; 2.066594e+00; 2.018666e+00; 1.986731e+00; 1.965115e+00; 1.950448e+00; 1.932109e+00; 1.928112e+00; 1.931210e+00; 1.938067e+00; 1.957025e+00; 1.978708e+00; 2.001005e+00; 2.023143e+00; 2.044828e+00; 2.065964e+00; 2.106612e+00; 2.145398e+00; 2.182661e+00; 2.218683e+00; 2.253655e+00; 2.337634e+00; 2.418054e+00; 2.496063e+00; 2.572371e+00; 2.721646e+00; 2.867931e+00; 3.012296e+00; 3.155668e+00; 3.298582e+00; 3.440993e+00; 3.724458e+00; 4.007849e+00; 4.291675e+00; 4.575755e+00; 4.860079e+00; 5.571583e+00; 6.284242e+00; 6.998056e+00; 7.712846e+00; 9.143666e+00; 1.057536e+01; 1.200693e+01; 1.343926e+01; 1.487279e+01; 1.630730e+01; 1.917804e+01; 2.205206e+01; 2.492847e+01; 2.780600e+01; 3.068402e+01]; 
    S = interp1q(E_tab,S_tab,E); 
    end 


    case 119 
    switch type 
    case 'col' 
    S_tab = [6.448415e+02; 6.507320e+02; 7.082133e+02; 7.115618e+02; 7.000234e+02; 6.844760e+02; 6.386866e+02; 5.966343e+02; 5.572459e+02; 5.222605e+02; 4.644110e+02; 4.203866e+02; 3.846798e+02; 3.548559e+02; 3.301825e+02; 3.088168e+02; 2.741885e+02; 2.510173e+02; 2.314239e+02; 2.146407e+02; 2.004457e+02; 1.741416e+02; 1.545090e+02; 1.390923e+02; 1.267061e+02; 1.081536e+02; 9.483988e+01; 8.471335e+01; 7.673356e+01; 7.026929e+01; 6.495775e+01; 5.660093e+01; 5.033055e+01; 4.543767e+01; 4.153250e+01; 3.831332e+01; 3.226770e+01; 2.803435e+01; 2.489360e+01; 2.246622e+01; 1.894159e+01; 1.649623e+01; 1.469420e+01; 1.330812e+01; 1.220717e+01; 1.131059e+01; 9.936665e+00; 8.931856e+00; 8.164253e+00; 7.558471e+00; 7.068184e+00; 6.173191e+00; 5.568593e+00; 5.133695e+00; 4.806652e+00; 4.350035e+00; 4.049447e+00; 3.839083e+00; 3.685459e+00; 3.569723e+00; 3.480405e+00; 3.354217e+00; 3.272280e+00; 3.217224e+00; 3.179521e+00; 3.153473e+00; 3.118952e+00; 3.108167e+00; 3.108907e+00; 3.115604e+00; 3.136823e+00; 3.161409e+00; 3.186015e+00; 3.209491e+00; 3.231469e+00; 3.251930e+00; 3.288597e+00; 3.320362e+00; 3.348130e+00; 3.372661e+00; 3.394510e+00; 3.440149e+00; 3.476501e+00; 3.506471e+00; 3.531780e+00; 3.572831e+00; 3.605243e+00; 3.631976e+00; 3.654694e+00; 3.674451e+00; 3.691916e+00; 3.721756e+00; 3.746638e+00; 3.768006e+00; 3.786710e+00; 3.803360e+00; 3.838306e+00; 3.866648e+00; 3.890458e+00; 3.911011e+00; 3.945181e+00; 3.972967e+00; 3.996407e+00; 4.016665e+00; 4.034517e+00; 4.050464e+00; 4.078048e+00; 4.101320e+00; 4.121486e+00; 4.139264e+00; 4.155156e+00]; 
    S = interp1q(E_tab,S_tab,E); 
    case 'tot' 
    S_tab = [6.448440e+02; 6.507346e+02; 7.082160e+02; 7.115646e+02; 7.000263e+02; 6.844790e+02; 6.386898e+02; 5.966376e+02; 5.572494e+02; 5.222642e+02; 4.644149e+02; 4.203907e+02; 3.846840e+02; 3.548603e+02; 3.301870e+02; 3.088215e+02; 2.741935e+02; 2.510224e+02; 2.314293e+02; 2.146463e+02; 2.004514e+02; 1.741477e+02; 1.545155e+02; 1.390989e+02; 1.267130e+02; 1.081608e+02; 9.484741e+01; 8.472110e+01; 7.674149e+01; 7.027737e+01; 6.496596e+01; 5.660935e+01; 5.033912e+01; 4.544636e+01; 4.154130e+01; 3.832220e+01; 3.227674e+01; 2.804349e+01; 2.490282e+01; 2.247550e+01; 1.895097e+01; 1.650567e+01; 1.470369e+01; 1.331766e+01; 1.221675e+01; 1.132021e+01; 9.946383e+00; 8.941669e+00; 8.174167e+00; 7.568490e+00; 7.078313e+00; 6.183610e+00; 5.579324e+00; 5.144759e+00; 4.818070e+00; 4.362226e+00; 4.062485e+00; 3.853037e+00; 3.700385e+00; 3.585670e+00; 3.497417e+00; 3.373485e+00; 3.293948e+00; 3.241426e+00; 3.206363e+00; 3.183064e+00; 3.155789e+00; 3.152721e+00; 3.161583e+00; 3.176745e+00; 3.215737e+00; 3.259050e+00; 3.303149e+00; 3.346746e+00; 3.389351e+00; 3.430900e+00; 3.510923e+00; 3.587302e+00; 3.660737e+00; 3.731859e+00; 3.801073e+00; 3.967819e+00; 4.128362e+00; 4.285001e+00; 4.438931e+00; 4.741774e+00; 5.040603e+00; 5.337354e+00; 5.633269e+00; 5.928991e+00; 6.224344e+00; 6.814050e+00; 7.404459e+00; 7.996385e+00; 8.589439e+00; 9.183474e+00; 1.067086e+01; 1.216168e+01; 1.365578e+01; 1.515231e+01; 1.814802e+01; 2.114683e+01; 2.414753e+01; 2.715091e+01; 3.015652e+01; 3.316447e+01; 3.918568e+01; 4.521258e+01; 5.124506e+01; 5.728144e+01; 6.331982e+01]; 
    S = interp1q(E_tab,S_tab,E); 
    end 


    case 202 
    switch type 
    case 'col' 
    S_tab = [3.924939e+02; 3.930503e+02; 4.345266e+02; 4.445813e+02; 4.413448e+02; 4.328282e+02; 4.043801e+02; 3.794606e+02; 3.556062e+02; 3.340116e+02; 2.977312e+02; 2.689482e+02; 2.456938e+02; 2.265297e+02; 2.104367e+02; 1.967202e+02; 1.745318e+02; 1.579760e+02; 1.444186e+02; 1.332198e+02; 1.238318e+02; 1.070711e+02; 9.515106e+01; 8.553314e+01; 7.779595e+01; 6.621638e+01; 5.802233e+01; 5.178472e+01; 4.687228e+01; 4.289584e+01; 3.960580e+01; 3.446435e+01; 3.061687e+01; 2.761949e+01; 2.521293e+01; 2.323402e+01; 1.953370e+01; 1.695065e+01; 1.503757e+01; 1.355942e+01; 1.141712e+01; 9.933342e+00; 8.841331e+00; 8.002186e+00; 7.336181e+00; 6.794154e+00; 5.964202e+00; 5.357716e+00; 4.894708e+00; 4.529512e+00; 4.234058e+00; 3.695006e+00; 3.331068e+00; 3.069685e+00; 2.873603e+00; 2.601019e+00; 2.422836e+00; 2.299232e+00; 2.209854e+00; 2.142650e+00; 2.090733e+00; 2.017236e+00; 1.969323e+00; 1.936979e+00; 1.914682e+00; 1.899134e+00; 1.878032e+00; 1.870710e+00; 1.870138e+00; 1.873071e+00; 1.883648e+00; 1.896419e+00; 1.909398e+00; 1.921899e+00; 1.933703e+00; 1.944758e+00; 1.964726e+00; 1.982219e+00; 1.997674e+00; 2.011443e+00; 2.023830e+00; 2.050048e+00; 2.071306e+00; 2.089027e+00; 2.104128e+00; 2.128734e+00; 2.148193e+00; 2.164178e+00; 2.177698e+00; 2.189377e+00; 2.199652e+00; 2.217103e+00; 2.231570e+00; 2.243946e+00; 2.254751e+00; 2.264350e+00; 2.284495e+00; 2.300834e+00; 2.314572e+00; 2.326438e+00; 2.346198e+00; 2.362308e+00; 2.375911e+00; 2.387674e+00; 2.398042e+00; 2.407319e+00; 2.423356e+00; 2.436897e+00; 2.448638e+00; 2.458986e+00; 2.468232e+00]; 
    S = interp1q(E_tab,S_tab,E); 
    case 'tot' 
    S_tab = [3.924953e+02; 3.930518e+02; 4.345281e+02; 4.445829e+02; 4.413464e+02; 4.328299e+02; 4.043818e+02; 3.794625e+02; 3.556081e+02; 3.340136e+02; 2.977333e+02; 2.689503e+02; 2.456960e+02; 2.265320e+02; 2.104391e+02; 1.967226e+02; 1.745343e+02; 1.579787e+02; 1.444213e+02; 1.332227e+02; 1.238347e+02; 1.070742e+02; 9.515426e+01; 8.553644e+01; 7.779934e+01; 6.621991e+01; 5.802594e+01; 5.178841e+01; 4.687602e+01; 4.289963e+01; 3.960962e+01; 3.446823e+01; 3.062079e+01; 2.762343e+01; 2.521689e+01; 2.323800e+01; 1.953770e+01; 1.695467e+01; 1.504160e+01; 1.356345e+01; 1.142117e+01; 9.937403e+00; 8.845405e+00; 8.006273e+00; 7.340279e+00; 6.798266e+00; 5.968349e+00; 5.361901e+00; 4.898935e+00; 4.533785e+00; 4.238379e+00; 3.699455e+00; 3.335657e+00; 3.074423e+00; 2.878501e+00; 2.606266e+00; 2.428465e+00; 2.305274e+00; 2.216336e+00; 2.149593e+00; 2.098159e+00; 2.025683e+00; 1.978857e+00; 1.947659e+00; 1.926554e+00; 1.912247e+00; 1.894419e+00; 1.890589e+00; 1.893700e+00; 1.900478e+00; 1.919146e+00; 1.940468e+00; 1.962371e+00; 1.984107e+00; 2.005398e+00; 2.026151e+00; 2.066044e+00; 2.104107e+00; 2.140678e+00; 2.176009e+00; 2.210331e+00; 2.292706e+00; 2.371599e+00; 2.448117e+00; 2.522965e+00; 2.669371e+00; 2.812841e+00; 2.954430e+00; 3.095044e+00; 3.235201e+00; 3.374862e+00; 3.652854e+00; 3.930742e+00; 4.209098e+00; 4.487673e+00; 4.766497e+00; 5.464212e+00; 6.163082e+00; 6.863074e+00; 7.564024e+00; 8.967140e+00; 1.037112e+01; 1.177499e+01; 1.317965e+01; 1.458539e+01; 1.599211e+01; 1.880731e+01; 2.162562e+01; 2.444641e+01; 2.726829e+01; 3.009063e+01]; 
    S = interp1q(E_tab,S_tab,E); 
    end 


    case 251 
    switch type 
    case 'col' 
    S_tab = [4.396656e+02; 4.403124e+02; 4.812511e+02; 4.863562e+02; 4.801390e+02; 4.693601e+02; 4.369266e+02; 4.084256e+02; 3.816967e+02; 3.578498e+02; 3.181904e+02; 2.869515e+02; 2.618066e+02; 2.411486e+02; 2.238445e+02; 2.091287e+02; 1.853566e+02; 1.685849e+02; 1.543157e+02; 1.425259e+02; 1.325676e+02; 1.147036e+02; 1.017023e+02; 9.136424e+01; 8.308157e+01; 7.071570e+01; 6.192065e+01; 5.524079e+01; 4.998576e+01; 4.573470e+01; 4.221877e+01; 3.672669e+01; 3.261940e+01; 2.942049e+01; 2.685254e+01; 2.474153e+01; 2.079539e+01; 1.804187e+01; 1.600291e+01; 1.442793e+01; 1.214576e+01; 1.056559e+01; 9.402822e+00; 8.509457e+00; 7.800507e+00; 7.223590e+00; 6.340334e+00; 5.694997e+00; 5.202373e+00; 4.813853e+00; 4.499550e+00; 3.926164e+00; 3.539085e+00; 3.261093e+00; 3.052566e+00; 2.762672e+00; 2.573164e+00; 2.441582e+00; 2.345541e+00; 2.273062e+00; 2.217028e+00; 2.137619e+00; 2.085765e+00; 2.050686e+00; 2.026431e+00; 2.009458e+00; 1.986237e+00; 1.977932e+00; 1.976964e+00; 1.979824e+00; 1.990747e+00; 2.004134e+00; 2.017818e+00; 2.031040e+00; 2.043525e+00; 2.055229e+00; 2.076382e+00; 2.094895e+00; 2.111230e+00; 2.125761e+00; 2.138807e+00; 2.166373e+00; 2.188615e+00; 2.207095e+00; 2.222803e+00; 2.248345e+00; 2.268530e+00; 2.285107e+00; 2.299143e+00; 2.311298e+00; 2.322012e+00; 2.340239e+00; 2.355397e+00; 2.368377e+00; 2.379729e+00; 2.389827e+00; 2.411046e+00; 2.428272e+00; 2.442770e+00; 2.455288e+00; 2.476166e+00; 2.493194e+00; 2.507560e+00; 2.520001e+00; 2.530968e+00; 2.540769e+00; 2.557720e+00; 2.572053e+00; 2.584461e+00; 2.595406e+00; 2.605185e+00]; 
    S = interp1q(E_tab,S_tab,E); 
    case 'tot' 
    S_tab = [4.396671e+02; 4.403140e+02; 4.812527e+02; 4.863579e+02; 4.801407e+02; 4.693618e+02; 4.369284e+02; 4.084275e+02; 3.816987e+02; 3.578518e+02; 3.181926e+02; 2.869538e+02; 2.618089e+02; 2.411510e+02; 2.238470e+02; 2.091312e+02; 1.853592e+02; 1.685876e+02; 1.543185e+02; 1.425288e+02; 1.325706e+02; 1.147068e+02; 1.017055e+02; 9.136763e+01; 8.308504e+01; 7.071930e+01; 6.192434e+01; 5.524455e+01; 4.998957e+01; 4.573856e+01; 4.222266e+01; 3.673063e+01; 3.262338e+01; 2.942449e+01; 2.685656e+01; 2.474557e+01; 2.079945e+01; 1.804594e+01; 1.600699e+01; 1.443202e+01; 1.214986e+01; 1.056970e+01; 9.406950e+00; 8.513597e+00; 7.804660e+00; 7.227758e+00; 6.344537e+00; 5.699240e+00; 5.206659e+00; 4.818186e+00; 4.503932e+00; 3.930678e+00; 3.543742e+00; 3.265903e+00; 3.057539e+00; 2.768002e+00; 2.578884e+00; 2.447724e+00; 2.352132e+00; 2.280125e+00; 2.224583e+00; 2.146218e+00; 2.095473e+00; 2.061564e+00; 2.038527e+00; 2.022822e+00; 2.002944e+00; 1.998206e+00; 2.001000e+00; 2.007789e+00; 2.026982e+00; 2.049109e+00; 2.071915e+00; 2.094579e+00; 2.116765e+00; 2.138389e+00; 2.179932e+00; 2.219499e+00; 2.257442e+00; 2.294039e+00; 2.329535e+00; 2.414589e+00; 2.495856e+00; 2.574568e+00; 2.651486e+00; 2.801805e+00; 2.949047e+00; 3.094347e+00; 3.238654e+00; 3.382497e+00; 3.525841e+00; 3.811181e+00; 4.096444e+00; 4.382158e+00; 4.668059e+00; 4.954224e+00; 5.670324e+00; 6.387601e+00; 7.105956e+00; 7.825246e+00; 9.265069e+00; 1.070577e+01; 1.214638e+01; 1.358776e+01; 1.503016e+01; 1.647370e+01; 1.936286e+01; 2.225490e+01; 2.514942e+01; 2.804534e+01; 3.094196e+01]; 
    S = interp1q(E_tab,S_tab,E); 
    end 


    case 262 
    switch type 
    case 'col' 
    S_tab = [4.026860e+02; 4.026210e+02; 4.402630e+02; 4.450300e+02; 4.393690e+02; 4.294240e+02; 3.996210e+02; 3.735470e+02; 3.490990e+02; 3.272840e+02; 2.910030e+02; 2.624360e+02; 2.394460e+02; 2.205580e+02; 2.047330e+02; 1.912670e+02; 1.695240e+02; 1.541950e+02; 1.411550e+02; 1.303250e+02; 1.211790e+02; 1.048150e+02; 9.293690e+01; 8.348770e+01; 7.591040e+01; 6.460250e+01; 5.656440e+01; 5.045970e+01; 4.565750e+01; 4.177300e+01; 3.856060e+01; 3.354300e+01; 2.979040e+01; 2.686810e+01; 2.452230e+01; 2.259400e+01; 1.898960e+01; 1.647450e+01; 1.461230e+01; 1.317390e+01; 1.108980e+01; 9.646700e+00; 8.584880e+00; 7.769090e+00; 7.121720e+00; 6.594920e+00; 5.788410e+00; 5.199160e+00; 4.749360e+00; 4.394620e+00; 4.107650e+00; 3.584130e+00; 3.230710e+00; 2.976900e+00; 2.786510e+00; 2.521840e+00; 2.348820e+00; 2.228790e+00; 2.141790e+00; 2.076190e+00; 2.025500e+00; 1.953690e+00; 1.906840e+00; 1.875180e+00; 1.853320e+00; 1.838050e+00; 1.817230e+00; 1.809900e+00; 1.809190e+00; 1.811910e+00; 1.822030e+00; 1.834330e+00; 1.846870e+00; 1.858970e+00; 1.870390e+00; 1.881080e+00; 1.900410e+00; 1.917320e+00; 1.932250e+00; 1.945540e+00; 1.957470e+00; 1.982690e+00; 2.003080e+00; 2.020030e+00; 2.034450e+00; 2.057920e+00; 2.076470e+00; 2.091710e+00; 2.104610e+00; 2.115770e+00; 2.125600e+00; 2.142310e+00; 2.156190e+00; 2.168070e+00; 2.178460e+00; 2.187690e+00; 2.207080e+00; 2.222810e+00; 2.236050e+00; 2.247490e+00; 2.266550e+00; 2.282080e+00; 2.295190e+00; 2.306540e+00; 2.316540e+00; 2.325490e+00; 2.340950e+00; 2.354030e+00; 2.365340e+00; 2.375330e+00; 2.384250e+00]; 
    S = interp1q(E_tab,S_tab,E); 
    case 'tot' 
    S_tab = [4.026874e+02; 4.026224e+02; 4.402645e+02; 4.450315e+02; 4.393705e+02; 4.294256e+02; 3.996227e+02; 3.735487e+02; 3.491008e+02; 3.272859e+02; 2.910050e+02; 2.624380e+02; 2.394481e+02; 2.205602e+02; 2.047352e+02; 1.912693e+02; 1.695264e+02; 1.541975e+02; 1.411576e+02; 1.303277e+02; 1.211817e+02; 1.048179e+02; 9.293989e+01; 8.349078e+01; 7.591355e+01; 6.460577e+01; 5.656775e+01; 5.046312e+01; 4.566097e+01; 4.177651e+01; 3.856414e+01; 3.354658e+01; 2.979402e+01; 2.687174e+01; 2.452596e+01; 2.259767e+01; 1.899329e+01; 1.647821e+01; 1.461601e+01; 1.317762e+01; 1.109353e+01; 9.650445e+00; 8.588637e+00; 7.772858e+00; 7.125500e+00; 6.598714e+00; 5.792236e+00; 5.203022e+00; 4.753262e+00; 4.398564e+00; 4.111639e+00; 3.588238e+00; 3.234949e+00; 2.981278e+00; 2.791037e+00; 2.526691e+00; 2.354027e+00; 2.234381e+00; 2.147789e+00; 2.082619e+00; 2.032377e+00; 1.961516e+00; 1.915676e+00; 1.885081e+00; 1.864330e+00; 1.850213e+00; 1.832436e+00; 1.828353e+00; 1.831067e+00; 1.837363e+00; 1.855010e+00; 1.875265e+00; 1.896107e+00; 1.916800e+00; 1.937049e+00; 1.956768e+00; 1.994654e+00; 2.030723e+00; 2.065318e+00; 2.098690e+00; 2.131052e+00; 2.208591e+00; 2.282698e+00; 2.354464e+00; 2.424592e+00; 2.561619e+00; 2.695800e+00; 2.828192e+00; 2.959655e+00; 3.090667e+00; 3.221210e+00; 3.481020e+00; 3.740720e+00; 4.000820e+00; 4.261090e+00; 4.521580e+00; 5.173390e+00; 5.826230e+00; 6.480060e+00; 7.134740e+00; 8.445210e+00; 9.756450e+00; 1.106758e+01; 1.237934e+01; 1.369214e+01; 1.500589e+01; 1.763545e+01; 2.026753e+01; 2.290184e+01; 2.553743e+01; 2.817375e+01]; 
    S = interp1q(E_tab,S_tab,E); 
    end 


    case 278      
    switch type 
    case 'col' 
    S_tab = [3.708520e+02; 3.699670e+02; 4.133390e+02; 4.274090e+02; 4.260170e+02; 4.186570e+02; 3.922150e+02; 3.688770e+02; 3.463530e+02; 3.257420e+02; 2.908520e+02; 2.630170e+02; 2.404470e+02; 2.217970e+02; 2.061210e+02; 1.927460e+02; 1.710910e+02; 1.542640e+02; 1.407710e+02; 1.296810e+02; 1.203870e+02; 1.039670e+02; 9.254030e+01; 8.319830e+01; 7.566100e+01; 6.436910e+01; 5.641720e+01; 5.035630e+01; 4.558090e+01; 4.171460e+01; 3.851490e+01; 3.351400e+01; 2.977170e+01; 2.685650e+01; 2.451570e+01; 2.259100e+01; 1.899240e+01; 1.648050e+01; 1.462010e+01; 1.318280e+01; 1.109970e+01; 9.656950e+00; 8.595180e+00; 7.779290e+00; 7.131750e+00; 6.604770e+00; 5.797860e+00; 5.208220e+00; 4.758090e+00; 4.403040e+00; 4.115800e+00; 3.591750e+00; 3.237940e+00; 2.983830e+00; 2.793210e+00; 2.528220e+00; 2.355000e+00; 2.234830e+00; 2.147990e+00; 2.083170e+00; 2.033130e+00; 1.962270e+00; 1.916080e+00; 1.884910e+00; 1.863410e+00; 1.848420e+00; 1.828070e+00; 1.820990e+00; 1.820400e+00; 1.823180e+00; 1.833270e+00; 1.845470e+00; 1.857880e+00; 1.869830e+00; 1.881120e+00; 1.891700e+00; 1.910830e+00; 1.927610e+00; 1.942450e+00; 1.955690e+00; 1.967620e+00; 1.992960e+00; 2.013570e+00; 2.030820e+00; 2.045560e+00; 2.069640e+00; 2.088710e+00; 2.104390e+00; 2.117640e+00; 2.129090e+00; 2.139150e+00; 2.156210e+00; 2.170340e+00; 2.182410e+00; 2.192940e+00; 2.202290e+00; 2.221900e+00; 2.237780e+00; 2.251140e+00; 2.262670e+00; 2.281880e+00; 2.297530e+00; 2.310740e+00; 2.322170e+00; 2.332240e+00; 2.341250e+00; 2.356830e+00; 2.370000e+00; 2.381400e+00; 2.391450e+00; 2.400440e+00]; 
    S = interp1q(E_tab,S_tab,E); 
    case 'tot' 
    S_tab = [3.708534e+02; 3.699684e+02; 4.133405e+02; 4.274105e+02; 4.260186e+02; 4.186586e+02; 3.922167e+02; 3.688788e+02; 3.463548e+02; 3.257439e+02; 2.908540e+02; 2.630191e+02; 2.404492e+02; 2.217993e+02; 2.061233e+02; 1.927484e+02; 1.710935e+02; 1.542666e+02; 1.407737e+02; 1.296838e+02; 1.203898e+02; 1.039700e+02; 9.254342e+01; 8.320152e+01; 7.566431e+01; 6.437254e+01; 5.642073e+01; 5.035990e+01; 4.558456e+01; 4.171830e+01; 3.851864e+01; 3.351779e+01; 2.977553e+01; 2.686036e+01; 2.451957e+01; 2.259489e+01; 1.899632e+01; 1.648443e+01; 1.462404e+01; 1.318674e+01; 1.110365e+01; 9.660915e+00; 8.599157e+00; 7.783278e+00; 7.135750e+00; 6.608783e+00; 5.801905e+00; 5.212303e+00; 4.762214e+00; 4.407207e+00; 4.120014e+00; 3.596089e+00; 3.242415e+00; 2.988451e+00; 2.797986e+00; 2.533335e+00; 2.360488e+00; 2.240721e+00; 2.154309e+00; 2.089939e+00; 2.040369e+00; 1.970505e+00; 1.925374e+00; 1.895321e+00; 1.874983e+00; 1.861203e+00; 1.844043e+00; 1.840365e+00; 1.843365e+00; 1.849892e+00; 1.867868e+00; 1.888401e+00; 1.909511e+00; 1.930464e+00; 1.951003e+00; 1.971034e+00; 2.009575e+00; 2.046398e+00; 2.081818e+00; 2.116074e+00; 2.149385e+00; 2.229456e+00; 2.306226e+00; 2.380759e+00; 2.453708e+00; 2.596472e+00; 2.736375e+00; 2.874414e+00; 3.011466e+00; 3.148070e+00; 3.284170e+00; 3.555000e+00; 3.825700e+00; 4.096830e+00; 4.368190e+00; 4.639790e+00; 5.319310e+00; 5.999900e+00; 6.681620e+00; 7.364310e+00; 8.730830e+00; 1.009809e+01; 1.146515e+01; 1.283297e+01; 1.420194e+01; 1.557175e+01; 1.831283e+01; 2.105730e+01; 2.380410e+01; 2.655165e+01; 2.929944e+01]; 
    S = interp1q(E_tab,S_tab,E); 
    end 
  
end
        
        
        







